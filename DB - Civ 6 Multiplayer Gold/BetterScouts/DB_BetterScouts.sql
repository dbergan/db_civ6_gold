-- Set baseline damage multipler to 20. We aren't actually using 20 in most situations, but because the modifier only adjusts downward by percentage, we have to start at 20 for Troop Intel, and then adjust upwards when that's not a factor. (standard = 10; also exists: COMBAT_WOUNDED_DISTRICT_DAMAGE_MULTIPLIER)
UPDATE GlobalParameters SET Value = 20 WHERE Name IN ('COMBAT_WOUNDED_DAMAGE_MULTIPLIER', 'COMBAT_WOUNDED_DISTRICT_DAMAGE_MULTIPLIER') ;

-- Set up normal damage decrement
INSERT OR REPLACE INTO GameModifiers (ModifierId) VALUES ('DB_MOD_ALL_UNITS_ATTACH_NORMAL_DAMAGE_DECREMENT') ;


INSERT OR REPLACE INTO Types 
(Type,																Kind) VALUES
('DB_ABILITY_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT',					'KIND_ABILITY'),
('DB_PROMOTION_CLASS_LATER_RECON',									'KIND_PROMOTION_CLASS')
;

INSERT OR REPLACE INTO UnitAbilities
(UnitAbilityType,													Inactive,	Name,																		Description) VALUES	
('DB_ABILITY_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT',					1,			'LOC_DB_ABILITY_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT_NAME',					'LOC_DB_ABILITY_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT_DESC')
;

INSERT OR REPLACE INTO UnitAbilityModifiers
(UnitAbilityType,													ModifierId)
VALUES	
('DB_ABILITY_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT',					'DB_MOD_SCOUT_TROOP_INTEL_PREVIEW') 
;


INSERT OR IGNORE INTO Tags (Tag, Vocabulary) VALUES ('DB_CLASS_BETTER_SCOUT', 'ABILITY_CLASS') ;

INSERT OR REPLACE INTO TypeTags
(Type,																Tag)
VALUES
('DB_ABILITY_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT',					'DB_CLASS_ALL'),
('ABILITY_STEALTH',													'DB_CLASS_BETTER_SCOUT')
;


INSERT OR REPLACE INTO Requirements
(RequirementId,														RequirementType,						Inverse) VALUES
('DB_REQ_DOESNT_HAVE_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT_ABILITY',	'REQUIREMENT_UNIT_HAS_ABILITY',			1)
;

INSERT OR REPLACE INTO RequirementArguments
(RequirementId,														Name,				Value) VALUES
('DB_REQ_DOESNT_HAVE_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT_ABILITY',	'UnitAbilityType',	'DB_ABILITY_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT')
;

INSERT OR REPLACE INTO RequirementSets
(RequirementSetId,														RequirementSetType) VALUES
('DB_REQSET_DOESNT_HAVE_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT_ABILITY',	'REQUIREMENTSET_TEST_ALL')
;

INSERT OR REPLACE INTO RequirementSetRequirements
(RequirementSetId,														RequirementId) VALUES
('DB_REQSET_DOESNT_HAVE_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT_ABILITY',	'DB_REQ_DOESNT_HAVE_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT_ABILITY')
;


INSERT OR IGNORE INTO UnitPromotionClasses (PromotionClassType, Name) VALUES 
('DB_PROMOTION_CLASS_LATER_RECON', 'LOC_DB_PROMOTION_CLASS_LATER_RECON_NAME') ;

UPDATE UnitPromotions SET PromotionClass = 'DB_PROMOTION_CLASS_LATER_RECON' WHERE PromotionClass = 'PROMOTION_CLASS_RECON' ;
UPDATE Units SET PromotionClass = 'DB_PROMOTION_CLASS_LATER_RECON' WHERE PromotionClass = 'PROMOTION_CLASS_RECON' ;

INSERT OR IGNORE INTO Types 
(Type,								Kind) VALUES
('DB_PROMOTION_SCOUT_DOUBLE_TIME',	'KIND_PROMOTION'),
('DB_PROMOTION_SCOUT_SPYGLASS',		'KIND_PROMOTION'),
('DB_PROMOTION_SCOUT_PATHFINDER',	'KIND_PROMOTION'),
('DB_PROMOTION_SCOUT_SENTRY',		'KIND_PROMOTION'),
('DB_PROMOTION_SCOUT_DISGUISE',		'KIND_PROMOTION'),
('DB_PROMOTION_SCOUT_ELUSIVE',		'KIND_PROMOTION'),
('DB_PROMOTION_SCOUT_TROOP_INTEL',	'KIND_PROMOTION')
-- ('DB_PROMOTION_SCOUT_STEALTH',		'KIND_PROMOTION') 
;

INSERT OR IGNORE INTO UnitPromotions
(UnitPromotionType,					Level,	Column,	PromotionClass,				Name,										Description) VALUES
('DB_PROMOTION_SCOUT_PATHFINDER',	1,		1,		'PROMOTION_CLASS_RECON',	'LOC_DB_PROMOTION_SCOUT_PATHFINDER_NAME',	'LOC_DB_PROMOTION_SCOUT_PATHFINDER_DESC'),
('DB_PROMOTION_SCOUT_DOUBLE_TIME',	1,		3,		'PROMOTION_CLASS_RECON',	'LOC_DB_PROMOTION_DOUBLE_TIME_NAME',		'LOC_DB_PROMOTION_DOUBLE_TIME_DESC'),
('DB_PROMOTION_SCOUT_SENTRY',		2,		1,		'PROMOTION_CLASS_RECON',	'LOC_DB_PROMOTION_SCOUT_SENTRY_NAME',		'LOC_DB_PROMOTION_SCOUT_SENTRY_DESC'),
('DB_PROMOTION_SCOUT_SPYGLASS',		2,		3,		'PROMOTION_CLASS_RECON',	'LOC_DB_PROMOTION_SPYGLASS_NAME',			'LOC_DB_PROMOTION_SPYGLASS_DESC'),
('DB_PROMOTION_SCOUT_DISGUISE',		3,		1,		'PROMOTION_CLASS_RECON',	'LOC_DB_PROMOTION_SCOUT_DISGUISE_NAME',		'LOC_DB_PROMOTION_SCOUT_DISGUISE_DESC'),
('DB_PROMOTION_SCOUT_ELUSIVE',		3,		3,		'PROMOTION_CLASS_RECON',	'LOC_DB_PROMOTION_ELUSIVE_NAME',			'LOC_DB_PROMOTION_ELUSIVE_DESC'),
('DB_PROMOTION_SCOUT_TROOP_INTEL',	4,		2,		'PROMOTION_CLASS_RECON',	'LOC_DB_PROMOTION_SCOUT_TROOP_INTEL_NAME',	'LOC_DB_PROMOTION_SCOUT_TROOP_INTEL_DESC')
-- ('DB_PROMOTION_SCOUT_STEALTH',		4,		3,		'PROMOTION_CLASS_RECON',	'LOC_DB_PROMOTION_STEALTH_NAME',			'LOC_DB_PROMOTION_STEALTH_DESC')
;

INSERT OR IGNORE INTO UnitPromotionModifiers
(UnitPromotionType,					ModifierId) VALUES
('DB_PROMOTION_SCOUT_PATHFINDER',	'DB_MOD_MOVEMENT_IGNORE_TERRAIN'),
('DB_PROMOTION_SCOUT_PATHFINDER',	'DB_MOD_MOVEMENT_IGNORE_RIVER'),
('DB_PROMOTION_SCOUT_DOUBLE_TIME',	'DB_MOD_+1_MOVEMENT'),
('DB_PROMOTION_SCOUT_SENTRY',		'DB_MOD_SEE_THROUGH_TERRAIN'),
('DB_PROMOTION_SCOUT_SPYGLASS',		'DB_MOD_+1_SIGHT'),
('DB_PROMOTION_SCOUT_DISGUISE',		'DB_MOD_ENTER_FOREIGN'),
('DB_PROMOTION_SCOUT_ELUSIVE',		'DB_MOD_IGNORE_ZOC'),
('DB_PROMOTION_SCOUT_TROOP_INTEL',	'DB_MOD_SCOUT_TROOP_INTEL')
-- ('DB_PROMOTION_SCOUT_STEALTH',		'DB_MOD_STEALTH')
;

INSERT OR IGNORE INTO Modifiers
(ModifierId,													ModifierType,											SubjectRequirementSetId) VALUES	
('DB_MOD_ALL_UNITS_ATTACH_NORMAL_DAMAGE_DECREMENT',				'MODIFIER_ALL_UNITS_ATTACH_MODIFIER',					null),
('DB_MOD_ALL_UNITS_ATTACH_NORMAL_DAMAGE_DECREMENT2',			'DB_DM_REDUCE_DAMAGE_DECREMENT_BY_PERCENT',				'DB_REQSET_DOESNT_HAVE_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT_ABILITY'),
('DB_MOD_SCOUT_TROOP_INTEL',									'DB_DM_GRANT_ABILITY_ALL_UNITS',						'DB_REQSET_ADJACENT_UNIT_AT_WAR'),
('DB_MOD_SCOUT_TROOP_INTEL_PREVIEW',							'MODIFIER_UNIT_ADJUST_COMBAT_STRENGTH',					null)
;

INSERT OR IGNORE INTO ModifierArguments
(ModifierId,													Name,					Value) VALUES
('DB_MOD_ALL_UNITS_ATTACH_NORMAL_DAMAGE_DECREMENT',				'ModifierId',			'DB_MOD_ALL_UNITS_ATTACH_NORMAL_DAMAGE_DECREMENT2'),
('DB_MOD_ALL_UNITS_ATTACH_NORMAL_DAMAGE_DECREMENT2',			'Amount',				50),
('DB_MOD_SCOUT_TROOP_INTEL',									'AbilityType',			'DB_ABILITY_SCOUT_TROOP_INTEL_DAMAGE_DECREMENT'),
('DB_MOD_SCOUT_TROOP_INTEL_PREVIEW',							'Amount',				0)
;

INSERT OR IGNORE INTO ModifierStrings
(ModifierId,													Context,	Text) VALUES	
('DB_MOD_SCOUT_TROOP_INTEL_PREVIEW',							'Preview',	'LOC_DB_MOD_SCOUT_TROOP_INTEL_PREVIEW')
;

UPDATE Units SET BaseMoves = 2, Description = 'LOC_DB_UNIT_SCOUT_DESC', FormationClass = 'FORMATION_CLASS_SUPPORT', PromotionClass = 'PROMOTION_CLASS_RECON', ZoneOfControl = 0, Combat = 0 WHERE UnitType = 'UNIT_SCOUT' ; 

INSERT OR IGNORE INTO TypeTags (Type, Tag) VALUES ('UNIT_SCOUT', 'DB_CLASS_BETTER_SCOUT') ;
DELETE FROM TypeTags WHERE Type = 'UNIT_SCOUT' AND Tag IN 
('DB_CLASS_ALL_COMBAT',
'DB_CLASS_LAND_COMBAT',
'DB_CLASS_MELEE_ATTACKER',
'DB_CLASS_LAND_MELEE_ATTACKER',
'DB_CLASS_LAND_MELEE_NON_CAVALRY') ;

DELETE FROM UnitUpgrades WHERE Unit = 'UNIT_SCOUT' ;
